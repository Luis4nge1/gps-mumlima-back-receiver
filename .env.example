# ==============================================
# GPS Processing Service - Environment Configuration
# ==============================================

# Server Configuration
PORT=3000
HOST=localhost
NODE_ENV=development

# ==============================================
# Redis Configuration
# ==============================================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# Redis Key Prefixes
REDIS_LAST_POSITION_PREFIX=gps:last:
REDIS_HISTORY_PREFIX=gps:history:
REDIS_QUEUE_PREFIX=gps:queue:

# ==============================================
# Batch Processing Configuration
# ==============================================
# Interval for batch processing (milliseconds)
BATCH_INTERVAL=10000

# Maximum batch size before forcing processing
BATCH_MAX_SIZE=100

# Historical batch configuration
HISTORICAL_BATCH_MAX_SIZE=150
HISTORICAL_COMPRESSION=true

# Latest positions batch configuration
LATEST_BATCH_MAX_SIZE=50
LATEST_COMPRESSION=true

# ==============================================
# Queue Configuration
# ==============================================
# Main queue settings
QUEUE_NAME=gps-processing
QUEUE_CONCURRENCY=5

# Historical queue settings
HISTORICAL_QUEUE_CONCURRENCY=5
HISTORICAL_REMOVE_ON_COMPLETE=100
HISTORICAL_REMOVE_ON_FAIL=50

# Latest positions queue settings
LATEST_QUEUE_CONCURRENCY=3
LATEST_REMOVE_ON_COMPLETE=50
LATEST_REMOVE_ON_FAIL=25

# ==============================================
# Data Processing Configuration
# ==============================================
# Duplicate detection
DUPLICATE_DETECTION=true
DUPLICATE_TIME_THRESHOLD=1000
DUPLICATE_COORDINATE_THRESHOLD=0.0001

# Data validation
MIN_LATITUDE=-90
MAX_LATITUDE=90
MIN_LONGITUDE=-180
MAX_LONGITUDE=180
MAX_DEVICE_ID_LENGTH=50
DEVICE_ID_PATTERN="^[a-zA-Z0-9_-]+"
MAX_TIMESTAMP_AGE=86400000
MAX_TIMESTAMP_FUTURE=300000

# ==============================================
# Compression Configuration
# ==============================================
COMPRESSION_ENABLED=true
COMPRESSION_LEVEL=6
COMPRESSION_THRESHOLD=1024

# ==============================================
# Cleanup Configuration
# ==============================================
CLEANUP_ENABLED=true
CLEANUP_INTERVAL=3600000
MAX_HISTORY_ENTRIES=100000
MAX_COMPLETED_JOBS=100
MAX_FAILED_JOBS=50
MAX_DEVICE_INACTIVITY=604800000

# ==============================================
# Rate Limiting Configuration
# ==============================================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_WINDOW=60000
RATE_LIMIT_MAX_REQUESTS=1000
RATE_LIMIT_SKIP_SUCCESS=false

# ==============================================
# Logging Configuration
# ==============================================
LOG_LEVEL=info
LOG_CONSOLE=true
LOG_FILE=false
LOG_FILENAME=gps-service.log

# ==============================================
# Metrics and Monitoring
# ==============================================
METRICS_ENABLED=true
METRICS_PORT=9090
METRICS_PATH=/metrics

# Health check configuration
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_PORT=8080
HEALTH_CHECK_PATH=/health
HEALTH_CHECK_TIMEOUT=5000

# ==============================================
# BigQuery Integration (Optional)
# ==============================================
# These would be used by external services that consume the history data
BIGQUERY_PROJECT_ID=your-project-id
BIGQUERY_DATASET_ID=gps_data
BIGQUERY_TABLE_ID=gps_positions
BIGQUERY_BATCH_SIZE=1000

# ==============================================
# Development/Testing Configuration
# ==============================================
# Enable additional debugging in development
DEBUG_ENABLED=false
DEBUG_BATCH_PROCESSING=false
DEBUG_QUEUE_PROCESSING=false
DEBUG_REDIS_OPERATIONS=false

# Test mode settings
TEST_MODE=false
TEST_SKIP_REDIS=false
TEST_MOCK_COMPRESSION=false

# Cache Data Max
CACHE_DATA=10000